%%
%% This is the original source file advi.sty
%%
%% Package `advi' to use with LaTeX 2e
%% Copyright Roberto Di Cosmo, Jun Furuse, Didier Remy, and Pierre Weis
%% All rights reserved.

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{advi-annot}
         [2001/29/08 v0.40 Advi Annot Package for advi Previewer]

%%% Advi Annotations
%% Identification
%% Preliminary declarations

%% Options

\DeclareOption {ps}{\PassOptionsToPackage{ps}{bubble}}
\ProcessOptions

\RequirePackage {advi}
\RequirePackage {bubble}

%% More declarations

%%% advi -> bubbles

\def \advi@@anchor {\advi@anchor{\the\advi@c@annot}}
\def \advi@@bubble #1{%
  \advi@ifadvi {\advi@record{\the\advi@c@annot}{#1}}{}}
\newcount \advi@c@annot

\newcommand {\advi@annot@text}[2][]{%
  \global \advance \advi@c@annot by 1%
  \leavevmode
  \bbb@[#1,anchor=\advi@@anchor,bubble=\advi@@bubble]%
       {\advi@anchor{advi@annot\the\advi@c@annot}{#2}}}

%%% advi ignore -> footnotes


\def \advi@skipparen #1(#2){#1}
\newcommand {\advi@annot@footi}[2][]{\footnote {#2}}

\newcommand {\advi@annot@foot}[2][]%
    {{#2}\@ifnextchar({\advi@skipparen{\advi@annot@footi}}%
      {\advi@annot@footi}}

%% So...

\def \advi@annot {\advi@ifadvi {\advi@annot@text}{\advi@annot@foot}}

%% exports

\advi@export \adviannot \advi@annot 
