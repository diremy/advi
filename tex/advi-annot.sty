%%
%% This is the original source file advi.sty
%%
%% Package `advi' to use with LaTeX 2e
%% Copyright Roberto Di Cosmo, Jun Furuse, Didier Remy, and Pierre Weis
%% All rights reserved.

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{advi-annot}
         [2001/29/08 v0.40 Advi Annot Package for advi Previewer]

%%% Advi Annotations
%% Identification
%% Preliminary declarations

%% Options

\DeclareOption {ps}{\PassOptionsToPackage{ps}{bubble}}
\ProcessOptions

\RequirePackage {advi}
\RequirePackage {bubble}

%% More declarations

\advi@ifadvi {

\newcommand{\ign@rebubble}[1][]{%
	\@ifnextchar({\bbb@gl@b[#1]}{\footbubble[#1]}%
}

\def\bbb@gl@b[#1](#2)#3{\footbubble[#1]{#3}}
\newcommand{\footbubble}[2][]{{#1}\footnote{#2}}

\newcommand {\advi@annot}[2][]{%
   \ign@rebubble[#2]
}
}
{
\def \advi@@anchor {\advi@anchor{\the\advi@c@annot}}
\def \advi@@bubble #1{%
   \advi@ifadvi {\advi@record{\the\advi@c@annot}{#1}}{}%
}
\newcount \advi@c@annot
\newcommand {\advi@annot}[2][]{%
   \global \advance \advi@c@annot by 1%
   \leavevmode
   \bubble [#1,anchor=\advi@@anchor,bubble=\advi@@bubble]%
        {\advi@anchor{advi@annot\the\advi@c@annot}{#2}}%
}
}

%% exports

\advi@export \adviannot \advi@annot 
