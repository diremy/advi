\documentclass[12pt]{article}

\usepackage {manual}
\usepackage {fullpage}
\usepackage {makeidx}

\expandafter \ifx \csname driver\endcsname\relax \def \driver{}\fi 
\usepackage [\driver]{hyperref}

\usepackage {graphicx}
\usepackage {advi}
\usepackage {advi-annot}
\usepackage {bubble}

\def \ActiveDVI {Active-DVI}

\newdimen \tmpdim
\title {\setbox0 \hbox {\bf\ActiveDVI}\global \tmpdim \wd0
\advance \tmpdim by 4em
\begin{tabular}{c}
\box0 \\
\includegraphics[width=\the\tmpdim]{../tex/bar.jpg.eps}\\
Reference manual
\end{tabular}
}
\author {Didier R{\'{e}}my and Pierre Weis}


% \def\adviheader{\noindent
% {\bf\Large \ActiveDVI}\\
% \includegraphics[width=\textwidth]{../tex/bar.jpg.eps}\par}

% %\let \Newpage \newpage
% %\def \newpage {\Newpage \adviheader}
% \def \Newpage {\newpage \adviheader}

\thispagestyle{empty}

\begin{document}


\maketitle

\def \abstractname {}
\begin{abstract}
{\bf\ActiveDVI}~is a viewer for DVI files that also recognizes a new class of 
\docdef \special's targeted to presentations via laptop computers:
various special effects can easily be incorporated to the presentation,
via a companion \doctt{advi} {\LaTeX} package. 

{\ActiveDVI} is copyright \copyright\space 2000, 2001, 2002 INRIA
and distributed under the Gnu Library General Public License ---see the LGPL
file included in the distribution.
\end{abstract}


\vfill
 \section* {Contributors}

The core of Active DVI is the plain DVI previewer, which was written by
Alexandre~Miquel. The other main implementors are Jun~Furuse,
Didier~R{\'{e}}my, and Pierre~Weis. Other contributors are Didier~Le~Botlan,  
Roberto~Di~Cosmo, Xavier~Leroy, and Alan~Schmitt. 


\clearpage
\tableofcontents
\clearpage


\section {Installation}

\section {Using the {\ActiveDVI} previewer}

\paragraph {\bf Warning!}

{\ActiveDVI} may execute programs and commands embedded into the DVI file.
To be safe, you should run \doctt{advi} with \doctt{-safer} option, 
will inhibits the execution of embedded applications. 
This applies in particular if you choose {\ActiveDVI} as your default 
{\tt meta-mail} previewer for the {\tt application/x-dvi} mime-type . 


\subsection {Command line options}

See the command help
\begin{verbatim}
advi -help
\end{verbatim}

\subsection {Cut and paste}

Text can copied from the {\ActiveDVI} previewer to an another application.
However, this uses \doctt{XBuffer} and not the \doctt{XSelection}
mechanism.
\begin {itemize}
\item
Shift middle-click copies the current word. 
\item
Shift right-click and drag copies the specified region. 
\end {itemize}
Moreover, Shift left-click dump an ASCII representation of click 
in the source file. This expects the DVI to be instrumented with line
numbers of the form
\begin{quote}
\doctt {line:} \docid {line} \docid {file}
\end{quote}
where \docid {line} and \docid {file} are the current source line and
current source file.

The position is exported in ASCII in the form
\begin{quote}
\verb"#line "\docid{before}, \docid{after} 
\doctt {<<}\docid{prefix}\doctt{>><<}\docid{suffix}\doctt{>>}
\docid{file} 
\end{quote}
where \docid {before} and  \docid {after} are the enclosing line numbers, 
\docid{prefix}\docid{suffix} are the word constituent surrounding the
position, and  file is the current file. 

Line numbers default to $0$ when not found. Note that line numbers may be
inconsistent if they \docdef \special-line commands have not been inserted
close enough to the position.


\subsection {Hyperref}

{\ActiveDVI} supports {\LaTeX} {\tt hyperref} package 
with both internal and cross-file references. For cross-file
references, it launches a new \verb"advi" process. 


\subsection {Moving around}

See the key bindings in the appendix.

\subsection {Using and making special effects}

\ActiveDVI~can be used as is, but will shine when driven by a user
with a bias toward programming: special effects can easily 
be realized by using the \LaTeX package provided with the distribution. 

Creative advanced users may program the presenter at various levels, either
using or defining simple {\LaTeX} macros, writing new {\LaTeX} package
files, or by implementing extension to the previewer itself.

Presentation examples can be found in the 
\verb"examples" directory. Don't miss to play them! Then, feel free
to read their source code and copy the effects they provide.

% If you ever succeed at adding a nice special effect that could be of
% a general interest, or if you can provide a nice and fancy presentation
% of your own that can serve as an example to the \ActiveDVI's users
% community, please don't hesitate to drop a mail to the implementors
% at \verb"advi@pauillac.inria.fr".


\section {The {\tt advi.sty} \LaTeX~package}

\ActiveDVI~provides some \LaTeX~packages to facilitate animations and
interaction with the presenter from within your \LaTeX source text.

The {\tt advi} package is the main package to include when writing
a presentation for \ActiveDVI. It provides the main set of interactive
commands for {\ActiveDVI} to animate the show. However, there is no
need to load the package if no {\ActiveDVI} special effects are
required for the presentation.

\subsection{Printing the presentation}

The {\tt advi} package recognizes the special option \verb"ignore",
which is devoted to help the production of a printable version of the
presentation: the \verb"ignore" option makes the package not to
produce {\tt advi} specials, so that the show can be previewed by
other previewers or turned into Postscript with {\tt dvips}. Of
course, this option disables most effects that cannot be printed,
although some of them are still approximated.

If the {\tt ignore} option is not set globally, it can be set
locally with the commands {\docdef \adviignore}. However, this will not
prevent all effects, since some decisions are taken when the package is
loaded.

The package also defines the conditional {\docdef \ifadvi} which
evaluates its first argument if advi is not in ignore mode and its
second argument otherwise.

\subsection {Pause, Record and Play}

\medskip\noindent
\docdef \adviwait\docopt{seconds}
\begin{quote}
Wait for \docid{seconds}. If no argument is provided, waits until the
user requests to continue (hitting a key to move to next pause or to
change page).
\end{quote}

\medskip\noindent
\docdef \advirecord \doctt{[play]}\docarg{tag}\docarg{latex code}
\\
\docdef \begin\doctt{\{advirecording\}}%
\doctt{[play]}\docarg{tag}\docarg{latex code}%
\docid {text}\docdef \end\doctt{\{advirecording\}}
\begin{quote}
Processes \docid{latex code} and records the corresponding DVI output,
bound to the tag \docid{tag}. When recording, the DVI output is
not displayed unless the option \doctt{play} is set.

Records can be nested. If so, the inner record is always recorded
with its own  tag; if the inner record is played when recording, it is
also recorded as part of the outer tag.

If the environment form is used, the \docid{latex code} may contain
fragile commands.
\end{quote}

\medskip\noindent
\docdef \adviplay\docopt{color}\docarg{tag}
\begin{quote}
Replay the DVI previously recorded and bound to \docid{tag}.
The optional argument changes the color to \docid{color} during replay. 
\end{quote}

\medskip\noindent
\docdef \advianchor\docopt{activation}\docarg{tag}\docarg{text}
\\
\docdef \begin\doctt{\{advianchoring\}}\docopt{activation}\docarg{tag}%
\docid {text}\docdef \end\doctt{\{advianchoring\}}

\begin{quote}
Plays the record bound to \docid{tag} when the anchor is activated.

The argument \docid{activation} may either be \doctt{over} or
\doctt{click}. The page is reset to its original appearance when the
anchor is no more activated (the mouse leaves the anchor area or the
button is released).

If the environment form is used, \docid{text} may contain fragile commands. 

\end{quote}


\subsection {Images}

Images can be encapsulated into the presentation using the package
CamlImages provided with the distribution.

\subsection {Backgrounds}

\medskip\noindent
\docdef \advibg \doctt {[global]}\docarg{key=value list}
\begin{quote}
where \docid{key=value list} is a list of bindings of the following kind:

\dockey[none]{color}{color}
\begin{quote}
Set the background color to \docid{color}
(\doctt{none} means unset).
\end{quote}

\dockey[none]{image}{file}
\begin{quote}
Use the image found in \docid{file} as background (\doctt{none} means unset).
\end{quote}

\dockey[auto]{fit}{fit style}
\begin{quote}
Fit the background image according to \docid{style}, which may be 
one of the following keywords:
\begin{center}
\tt
auto \hfill {\rm or} \hfill
\begin{tabular}{l@{\qquad}c@{\qquad}r}
topleft&   top& topright\\
left&  center&  right \\
bottomleft& bottom & bottomright\\
\end{tabular}
\end{center}
The {\tt auto} fit style means scaling the image as desired in both directions
so that it fits the entire page. Other styles only force the same scaling
factor in both directions:
\begin {itemize}

\item Corner-styles means set the image in the corresponding corner
and scale it to cover the entire page.

\item {\tt center} means set the image in the center of the page and
scale it to cover the entire page.

\item Segment-styles means adjust the image and the page on the
segment (in which case, the image may not completely cover the page on
the opposite side).

\end {itemize}
\end{quote}

\dockey[none]{alpha}{float}
\begin{quote}
Set the alpha channel factor for the background image to \docid{float}
(\doctt{none} means unset). An alpha factor of $0$ means that the
image is not visible at all; conversely, an alpha factor of $1$ means that the
image covers the background.
\end{quote}

\dockey[none]{blend}{blend mode}
\begin{quote}
Set the blend mode to \docid{blend mode}, which should be one of the
following (unchecked): {\tt difference}, XXX?
(\doctt{none} means unset).
\end{quote}

\goodbreak
\dockey{none}{}
\begin{quote}
Unset all background parameters.
This key must appear on its own, no arguments or keys are allowed. 
\end{quote}
The optional parameter \doctt{global} indicates that
the definition is global and will affect the following pages, 
as well as the current page.

By default, the background settings only affect the current page.
\end{quote}

\subsection {Transitions}

\docdef \advitransition \doctt {[global]}\docarg {key=val list}
\begin{quote}
where \docid{key=value list} is a list of bindings of the following kind:

\dockey{none}{} or \dockey{slide}{} or \dockey{block}{} or \dockey{wipe}{}
\begin{quote}
Set the transition mode to the corresponding key.
One of this key is mandatory (several is should be illegal, but in fact
overrides the previous one). 
\end{quote}

\dockey{from}{direction}
\begin{quote}
Make the transition come from \docid{direction}.  Directions are not checked
but should be one of the following: 
\begin{center}
\tt
\begin{tabular}{l@{\qquad}c@{\qquad}r}
topleft&   top& topright\\
left&  center&  right \\
bottomleft& bottom & bottomright\\
\end{tabular}
\end{center}
\end{quote}

\dockey{steps}{n}
\begin{quote}
Make the transition in \docid{n} steps. 
\end{quote}
As for \docdef \advibg, the optional parameter \doctt{global} indicates that
the definition is global and will affect the following pages, 
as well as the current page. 

By default, the transition definitions only affect the current page. 
\end{quote}

\medskip\noindent
\docdef \advitransbox \docarg {key=val list}\docarg{hbox material}
\begin{quote}
where \docid {key=val list} is as above and \docarg{hbox material} is
whatever can follow an \docdef \hbox{} command. In particular, the material
may contain verbatim commands, since as for the \docdef\hbox{} it is 
parsed incrementally.
\end{quote}

The optional parameter \doctt{global} indicates that
the definition is global and will affect the following pages, 
as well as the current page.

By default, the transition affects only the current page.

\subsection {Hyperref}

{\ActiveDVI} supports the \doctt{hyperref} {\LaTeX} package. 

Explain \verb"<a name>XXX</a>"

\subsection {Embed applications anchors}

The commands are 

\medskip\noindent
\docdef \adviembed\docopt{key=value list}\docarg{command} 

\begin{quote}
where \docid{key=value list} is a list of bindings of the following kind:

\dockey{name}{name}
\begin{quote}
Allows to refer to the embedded application as \docid{name}. 
Anonymous applications have actually the default name \doctt{anonymous}.
\end{quote}

\dockey{ephemeral}{name}

\begin{quote}
This is the default case: the embedded application is killed when the page
is turned.
\end{quote}

\dockey{persistent}{name}

\begin{quote}
The application keeps running in the background, but will only be visible in
the current page.
\end{quote}

\dockey{width}{dim}\\
\dockey{height}{dim}
\begin{quote}
The application takes \docid{dim} width (respectively height) space in 
latex. Both values default to 0pt.

These dimensions are also substituted for all occurrences of \verb"!g" in
the command string.
\end{quote}

\dockey{sticky}{name}
\begin{quote}
The application keep running and remains visible when turning pages.
\end{quote}

\end{quote}

\medskip\noindent
\docdef \advikillembed \docarg{name}
\begin{quote}
Kill all embedded applications named \docid{name}
\end{quote}


\subsection {Active anchors}

The command is 

\medskip\noindent
\docdef \advianchor \docarg{tag}\docarg {text}
\\
\docdef \begin\doctt{\{advianchor\}}\docarg{tag}%
\docid {text}\docdef \end\doctt{\{advianchor\}}
\begin{quote}
The text is first display as usual and mark as active. 
Moving the mouse above the text will display the record \docid{tag}.

In the environment form, \docid{text} may contain fragile commands. 
\end{quote}

\subsection {Postscript specials}

{\ActiveDVI} can deal with most of PStricks calling {\tt ghostscript} on
included Postscripts. However, the interactive between {\ActiveDVI} and
Postscripts is not always working.
\begin {itemize}

\item
Since characters are rendered by {\ActiveDVI}, some PStricks are not allowed.
\item
Some change of repairs are also not yet correctly performed.  
\end {itemize}

\subsubsection {Overlays}

\index{overlays}

The {\tt overlay} class implements overlays with PStricks.  Instead,
{\ActiveDVI} implements overlays directly, using records and plays.
This is more efficient, and of course more natural.
(In fact, {\ActiveDVI} chooses the cumulative semantics of overlays
display if all layers below the current overlay.)

The {\tt xprosper} style derived from the {\tt prosper} class uses 
the {\tt overlay} class and also work with {\ActiveDVI} in exactly the same
way (relaxing the \overlay@loop macro inhibits all layers, but the first
page). 

\subsubsection {PStricks}

{\ActiveDVI} can deal with most of PStricks. 
\begin {itemize}

\item[+]
Simple drawings work

\item[+] 
{\tt\string\SpecialCoor} works, {\em i.e.} commands of the form
{\tt \string \rput \{A\}\{bla bla\}} works where {\tt A} is a node

\item[+]
Connections between nodes {\tt \string \ncarc}, {\tt \string \ncarc},
also works.
\end {itemize}
However, some PStricks are known not to work.
\begin{itemize}
\item[--]
Labels over arrows \verb"\Aput", \verb"Bput", etc.
(they change the Postscript coordinates...)

\item[--]
{\tt pspicture}
(idem, but drawings that are not embedded in pspictures works)

\end {itemize}


\section {Auxiliary \LaTeX~packages}

\subsection{The superpose package}

This package allows to easily superpose horizontal material, creating 
the smallest horizontal box to fit all of the superpositions.
\begin{verbatim}
\usepackage{superpose}
\end{verbatim}
The package defines a single environment:

\medskip\noindent
\docdef\begin\doctt{\{superpose\}}\docopt{alignment}\docid {list}%
\docdef\end\doctt{\{superpose\}}
\begin{quote}
The \docid{alignment} can be one the letters \doctt c (default value), \doctt
l, or \doctt r.

Items of the list are separated by \verb"\\" as in tabular environments.
Each item should be a horizontal material.
\end{quote}

\subsection{The bubble package}

This package allows to easily draw bubbles over some text. 
\begin{verbatim}
\usepackage{bubble}
\usepackage[ps]{bubble}
\end{verbatim}
By default bubbles are produced using the \doctt{epic} and \doctt{eepic}
packages, for portability. However, for better rendering and easier 
parameterization, bubbles can also be drawn using the \doctt{ pst-node}
package of the pstricks collection. This is what the \doctt{ps} option
is designed for.

The package defines a single command:

\medskip\noindent
\docdef \bubble \docopt{key=value list}\docarg{anchor}%
    \docopt{ps options}\docpar {pos}\docarg{text}
\begin{quote}
The \docid{key=value list} is a list of bindings of the following kind:

\dockey[yellow]{bg}{color}
\begin{quote}
The background color for annotations. 
\end{quote}

\dockey[yellow]{unit}{dim}
\begin{quote}
Set the package unit to \docid{dim}.
\end{quote}

\dockey[c]{col}{colspec}
\begin{quote}
Where \docid{colspec} is a column specification for the tabular
environment. Moreover, the following abbreviations are recognized:

\smallskip
\tt
\begin{tabular}{|l|l|}
\hline
\rm\em key & \rm expands to \\
\hline
c &  col=c\\
l &  col=l\\
r &  col=r\\
p=\docid{w} & col=p\docarg{w}\\
\cline{1-2}
\end{tabular}
\begin{tabular}{|l|l|}
\hline
\rm\em key & \rm expands to \\
\hline
C &  col=\{>\{\$\}c<\{\$\}\}\\
L &  col=\{>\{\$\}l<\{\$\}\}\\
R &  col=\{>\{\$\}r<\{\$\}\}\\
P\docid{w} &  \doctt{col=\{>\{\$\}p\docarg{w}<\{\$\}\}}\\
\cline{1-2}
\end{tabular}
\end{quote}

\docid{pos} is the optional relative position of the annotation, 
it defaults to $1,1$, and is counted in the package units. 

\docid{ps options} are passed to the command \docdef\psset) 
in \doctt{ps} mode and ignored otherwise. 
\end{quote}
Parameters (color and tabular columns specifications) can also 
be set globally using the command:

\medskip \noindent
\docdef \setkeys\doctt{\{bubbleset\}}\docarg{key=value list}

\subsection{The annotations package}

This package uses active anchors and the bubbles package to 
allow annotations by raising a bubble when the cursor is over the anchor.

The package provides a single command

\medskip\noindent
\docdef \adviannot \docopt{key=value list}\docarg{anchor}%
    \docopt{ps options}\docpar {pos}\docarg{text}
\begin{quote}
whose options are identical to those of \docdef \bubble, but the bubble
appears withing an active anchor. 
\end{quote}

%Annotation location can also be invisible \advi{C}{\tt{ }}instead of visible.

\appendix

\section {Limitations}

\subsection*{Postscript Fonts}

Postscript fonts are not currently supported. 

\subsection*{Inlined Postscript and Ghostscript}

PS relies on {\tt ghostscript} to display Postscript inlined specials.
However, some earlier releases of {\tt ghostscript} 
implements Postscript {\tt flushpage} command as a {\tt XFlush} call
which does not force the evaluation of commands, and thus makes the 
synchronization between {\tt ghostscript} and \ActiveDVI~drawings 
uncontrollable. In this case, the interleaving of inlined postscript 
and other material may be inconsistent. 

Fortunately, recent versions of ghostscript $(> 6.5)$ have
fixed this problem by using {\tt XSync(false)} instead.
If you use those versions of ghostscript, inlined specials should be
correctly rendered.

Unfortunately, some releases of version 6.5x also carry a small but
fatal bug for \ActiveDVI, that will hopefully be fixed in future
releases. A workaround is available here
\url{http://cristal.inria.fr/~remy/ghostscript/}.

\subsection*{Inlined Postscript change of coordinates}

So far, the implementation of inlined Postscript does not correctly handle
complex change of coordinates.  (See PStricks section). 

\section {Bug Reports}

Please, send bug reports to 
\url{mailto:advi@cristal.inria.fr}. 
\\
See \url{http://cristal.inria.fr/activedvi} for up to date information.


\section {Key bindings}

\section {Index}

\printindex

\end{document}

% LocalWords:  DVI Didier Weis advi INRIA LGPL Miquel Furuse Botlan XBuffer pst
% LocalWords:  XSelection Hyperref hyperref dvips advirecording advianchoring
% LocalWords:  CamlImages topleft topright bottomleft bottomright hbox PStricks
% LocalWords:  advianchor eepic pstricks ps pos bg colspec bubbleset inlined
% LocalWords:  flushpage XFlush XSync
